## 线性近似和牛顿法
线性近似是求 $f(x)$ 的值；牛顿法是求 $F(x)=0$ 的解。下面推导一下：  
在 $x=a$ 处，
$$
\frac{\operatorname d f}{\operatorname d x}=f'(a)\approx \frac{f(x) - f(a)}{x - a} \tag1
$$
这里 $x$ 不趋向于 $a$ ，是 $a$ 附近的一个点，所以不用等于而是约等于。  
由式(1)可以推导出**线性近似公式**：  
$$f(x)\approx f(a)+(x-a)f'(a)\tag2$$  
求解线性近似问题，需要在要求的 $x$ 附近，有一个点 $a$ 容易算得 $f(a)$ 并知道其导数 $f'(a)$ 。
由式(1)也可以推导出**牛顿法的公式**：  
求 $F(x)=0$ 的解，将式(2)中的 $f(x)$ 替换为 $F(x)$ 得：  
$$
0\approx f(a)+(x-a)f'(a) \\[2ex]
x\approx a-\frac{F(a)}{F'(a)} \\[2ex]
$$
![](attachments/13线性近似和牛顿法（2）.jpg)
  
例：求 $\sqrt{9.06}$ 的值。  
方法一（线性近似法）：
令 $f(x)=\sqrt{x}$ ， $f'(x)=\frac{1}{2}x^{-\frac{1}{2}}$ ，取 $a=9$ 得：  
$$
f(9.06)\approx f(9)+(9.06-9)f'(9)=3+0.06\times\frac{1}{6}=3.01
$$
这里就已经求得了线性近似值，从下面的图像可知，在 $9.06$ 的附近，取了 $a=9$ 这个容易算得 $f(a)=3$ 的点，再加上一个差值即可。这个差值就是 $y$ 方向上的差值，是根据斜率 $f'(a)=1/6$ 和 $x$ 方向的差值 $\Delta x = 9.06-9=0.06$ 算出 $y$ 方向的差值 $\Delta y=f'(a)\Delta x=1/6\times 0.06=0.01$ 。最后，就可以得出线性近似值： $f(a)+0.01=3+0.01=3.01$ 。
![](attachments/13线性近似和牛顿法（3）.jpg)
  
方法二（牛顿法）：
构建函数 $F(x) = x^2-9.06$ ， $F'(x) = 2x$ ，令 $F(x) = 0$ ，求解 $F(x)$ ，令 $a=3$ 。  
$$
x\approx 3-\frac{F(3)}{F'(3)} \\[2ex]
x\approx 3-\frac{-0.06}{6} \\[2ex]
x\approx 3.01 \\[2ex]
$$
与方法一求得的结果相同。下面再画下图，发现这个问题就是已知斜率（导数） $F'(a)$ 和切点 $(a,F(a))$ ，求该切线与 $x$ 轴的截距。看图也比较容易求出来，该切线与 $x$ 轴的截距为 $x=a+\Delta x$ ，而 $\Delta x = F(3)/F'(3)$ 。  
![](attachments/13线性近似和牛顿法（4）.jpg)
  
可以将上次求解的值再次带入计算，令 $a_{new}=3.01$ ，再次求解 $F(x)$ ：
$$
x_{new}\approx 3.01-\frac{F(3.01)}{F'(3.01)} \\[2ex]
x_{new}\approx 3.01-\frac{0.0001}{6.02} \\[2ex]
x_{new}\approx 3.00998338870 \\[2ex]
$$
$x=3.01$ 时， $error=x^2 - 9.06=3.01^2-9.06=0.0001$ ；  
$x=3.00998338870$ 时， $error=x^2 - 9.06=3.00998338870^2-9.06\approx0.00000000025$ 。  
可以发现，迭代后误差变小了很多。网上找到了一张动图，非常清晰明了地说明了牛顿迭代法：  
![](attachments/%E7%89%9B%E9%A1%BF%E6%B3%95.gif)
  
例：求 ${\rm e}^{0.01}$ 的值。  
令 $f(x)={\rm e}^x$ ， $f'(x)={\rm e}^x$ ，取 $a=0$ 得：  
$$
f(x)\approx f(0)+(x-0)f'(0)=1+x=1+0.01=1.01
$$
这里已经得出了答案，再观察下上面的式子 $f(x)={\rm e}^x\approx1+x$ 发现线性近似与**幂级数**类似，比如 ${\rm e}^x=1+x+x^2/2+\cdots$ ，相当于幂级数从常数项和线性项之后拦腰截断。  
![](attachments/13线性近似和牛顿法（8）.jpg)  
PS：这里补充下牛顿法失效的四种情况（详见《普林斯顿微积分读本》13.3牛顿法的最后部分）：  
1. $f'(a)$ 的值接近于 $0$ 。这种情况下，在 $x=a$ 处的切线接近于水平，牛顿法会给出一个很糟糕的结果。为了避免这种情况，要确保初始值不在函数 $f$ 的临界点附近；
2. 如果 $f(x)=0$ 有不止一个解，可能得到的不是你想要的那个解；
3. 近似可能变得越来越糟，例如 $f(x)=x^{1/3}$ ，可以尝试使用牛顿法求解 $f(x)=0$ ；
4. 你可能陷入一个循环而无法自拔。有可能通过估算 $a$ 得到 $b$，估算 $b$ 又得到 $a$ 。
  
在实际应用中，使用牛顿迭代法的函数一般是单调的，故只有一个解。判断第一种情况是必须的，只有一个解就排除了情况二，情况三和情况四碰到的概率比较小，通过迭代次数和误差加以限制。